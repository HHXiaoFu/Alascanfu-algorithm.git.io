# :book: å¹¶æŸ¥é›†ç»“æ„ç†è§£ä¸å®ç°

## :bookmark_tabs: å¹¶æŸ¥é›†ç”¨äºè§£å†³çš„é—®é¢˜

> **å¿«é€Ÿè§£å†³é—®é¢˜**

- å°†ä¸¤ä¸ªé›†åˆåˆå¹¶
- è¯¢é—®ä¸¤ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé›†åˆå½“ä¸­

**å¹¶æŸ¥é›†å¯ä»¥è¿‘ä¹ O(1) çš„æ—¶é—´å¤æ‚åº¦ç»´æŠ¤ä¸Šè¿°ä¸¤ä¸ªæ“ä½œ**

**:bookmark_tabs: æœ´ç´ è§£æ³•**

**åˆ©ç”¨ä¸€ä¸ªæ•°ç»„belong[]æ¥è¿›è¡Œå­˜å‚¨å…ƒç´ x å±äºå“ªä¸€ä¸ªé›†åˆ**

```txt
belong[x] = a;
if(belong[x] == belong[y]) åˆ™è¯´æ˜äºŒè€…åœ¨åŒä¸€ä¸ªé›†åˆå½“ä¸­
```

**:bookmark: æ€æƒ³ç†è§£ï¼š**

- **æ¯ä¸€ä¸ªé›†åˆæˆ‘ä»¬ç”¨ä¸€æ£µæ ‘çš„å½¢å¼æ¥ç»´æŠ¤é›†åˆ**

- **æ¯ä¸ªèŠ‚ç‚¹çš„æ ¹èŠ‚ç‚¹çš„å€¼ä½œä¸ºé›†åˆçš„ç¼–å·**
- **å…¶ä¸­æ¯ä¸ªèŠ‚ç‚¹éœ€è¦è®°å½•å…¶çˆ¶èŠ‚ç‚¹æ˜¯è°ï¼Œp[x] è¡¨ç¤ºxçš„çˆ¶èŠ‚ç‚¹ï¼Œå¦‚æœå…¶çˆ¶èŠ‚ç‚¹ä¸æ˜¯æ ¹èŠ‚ç‚¹åˆ™ç»§ç»­æ‰¾çˆ¶èŠ‚ç‚¹ï¼Œç›´è‡³æ‰¾åˆ°çˆ¶èŠ‚ç‚¹å³å¯ç¡®å®šå…¶æ‰€åœ¨é›†åˆçš„ç¼–å·**

![image-20220509165439787](./unionTemplate.png)

:bookmark: **é—®é¢˜ä¸€ï¼šå¦‚ä½•åˆ¤æ–­æ ‘æ ¹ï¼Ÿ**

`if (p[x] == x) ` åˆ™å¯ä»¥è¯æ˜å…¶æ˜¯æ ‘çš„æ ¹èŠ‚ç‚¹ï¼ŒåŒæ—¶ä¹ŸçŸ¥é“å½“å‰æ ‘æ˜¯ä½œä¸ºç¼–å·ä¸º`x`çš„é›†åˆã€‚

:bookmark: **é—®é¢˜äºŒï¼šå¦‚ä½•æ±‚å– x çš„é›†åˆç¼–å·ï¼Ÿ**

```java
while (p[x] != x){
    x = p[x];
}
```

:bookmark: **é—®é¢˜ä¸‰ï¼šå¦‚ä½•åˆå¹¶ä¸¤ä¸ªé›†åˆï¼Ÿ**

![image-20220509170105003](./unionTemplate1.png)

`p[x]` æ˜¯ x çš„é›†åˆç¼–å· , `p[y]` æ˜¯ y çš„é›†åˆç¼–å·ã€‚`p[x] = y` å³å¯åˆå¹¶ä¸¤ä¸ªé›†åˆã€‚

## :bookmark_tabs: é’ˆå¯¹äº é—®é¢˜äºŒ çš„ä¼˜åŒ–

- å¦‚æœæ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦æ±‚å–å…¶é›†åˆç¼–å·ï¼Œè¯¥æ“ä½œçš„`æ—¶é—´å¤æ‚åº¦ä¸æ ‘çš„é«˜åº¦æˆæ­£æ¯”`ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½åœ°æ–¹æ¡ˆï¼Œæ‰€ä»¥é’ˆå¯¹äºæ­¤ï¼Œæˆ‘ä»¬`éœ€è¦å¯¹å…¶è¿›è¡Œä¼˜åŒ–`ã€‚

æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±è¦ç”¨åˆ° **ğŸ“– è·¯å¾„å‹ç¼©** çš„ä¼˜åŒ–æ–¹æ¡ˆäº†ï¼š

æˆ‘ä»¬åªéœ€è¦`è®¡ç®—ä¸€ä¸ªå¶å­èŠ‚ç‚¹`å…¶æ‰¾åˆ°æ ¹èŠ‚ç‚¹,ä¹Ÿå°±æ˜¯é›†åˆç¼–å·æ—¶ï¼Œ**å³å¯å°†è¯¥å¶å­èŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„æ‰€æœ‰è·¯å¾„èŠ‚ç‚¹å…¨éƒ¨ä¿®æ”¹ä¸ºç›´æ¥æŒ‡å‘æ ¹èŠ‚ç‚¹ä½œä¸ºçˆ¶èŠ‚ç‚¹ï¼Œè¿™å°±æ˜¯è·¯å¾„å‹ç¼©ã€‚**

![image-20220509170840143](./unionTemplate2.png)

## :bookmark_tabs: **ä»£ç å®ç°**

:bookmark_tabs: **Yæ€»æ¨¡æ¿ï¼š**

```java
import java.io.*;
import java.util.*;

class Main{
    static int N = 100010;
    static int[] p ;
    static void init(){
        p = new int[N];
    }
    // int find(int x) æ˜¯è¿”å›å…ƒç´ xæ‰€åœ¨é›†åˆçš„ç¼–å· + è·¯å¾„å‹ç¼©
    static int find(int x){
        if(p[x] != x)p[x] = find(p[x]);
        return p[x];
    }
    
}
```



[836. åˆå¹¶é›†åˆ - AcWingé¢˜åº“](https://www.acwing.com/problem/content/838/)

```java
class Main{
    static int N = 100010;
    static int[] p ;
    static void init(){
        p = new int[N];
    }
    // int find(int x) æ˜¯è¿”å›å…ƒç´ xæ‰€åœ¨é›†åˆçš„ç¼–å· + è·¯å¾„å‹ç¼©
    static int find(int x){
        if(p[x] != x)p[x] = find(p[x]);
        return p[x];
    }
    public static void main(String[] args )throws IOException{
        init();
        InputStreamReader in = new InputStreamReader(System.in);
        BufferedReader br = new BufferedReader(in);
        String[] params = br.readLine().split(" ");
        int n = Integer.parseInt(params[0]);
        int m = Integer.parseInt(params[1]);
        for (int i = 1; i <= n;i++){
            p[i] = i;
        }
        while (m -- >0){
            String[] params1 = br.readLine().split(" ");
            String operate = params1[0];
            int a = Integer.parseInt(params1[1]);
            int b = Integer.parseInt(params1[2]);
            if (operate.equals("M")){
                p[find(a)] = find(b);
            }else {
                if (find(a) == find(b)){
                    System.out.println("Yes");
                }else {
                    System.out.println("No");
                }
            }
        }
    }
}
```

## :bookmark_tabs: å¹¶æŸ¥é›† çš„å˜å½¢ä¸€

> **éœ€è¦è®¡ç®—è¿é€šå—çš„æ•°é‡ï¼Œéœ€è¦è®¡ç®—æ¯ä¸ªç¼–å·é›†åˆçš„æ•°é‡**

- è¿™é‡Œåªéœ€è¦ç»´æŠ¤ä¸€ä¸ª `size[]` æ•°ç»„å³å¯ï¼Œåœ¨åˆå¹¶è¿‡ç¨‹ä¹‹å‰è¿›è¡Œ`size[find(b)] += size[find(a)]` æ“ä½œï¼Œä¹‹åå†è¿›è¡Œåˆå¹¶ï¼Œ`p[find(a)] = find(b)`

[837. è¿é€šå—ä¸­ç‚¹çš„æ•°é‡ - AcWingé¢˜åº“](https://www.acwing.com/problem/content/839/)

```java
import java.io.*;
import java.util.*;

class Main{
    static int N =  100010;
    static int[] p , size;
    static void init (){
        p = new int[N];
        size = new int[N];
    }
    
    static int find(int x){
        if (p[x] != x)p[x] = find(p[x]);
        return p[x];
    }
    
    public static void main(String[] args )throws IOException{
        init();
        InputStreamReader in = new InputStreamReader(System.in);
        BufferedReader br = new BufferedReader(in);
        String[] params = br.readLine().split(" ");
        int n = Integer.parseInt(params[0]);
        int m = Integer.parseInt(params[1]);
        for (int i = 1; i <= n;i++){
            p[i] = i ;
            size[i] = 1;
        }
        while (m -- > 0){
            String[] params1 = br.readLine().split(" ");
            String operate = params1[0];
            if (operate.equals("C")){
                int a = Integer.parseInt(params1[1]);
                int b = Integer.parseInt(params1[2]);
                if (find(a) == find(b) ) continue;
                size[find(b)] += size[find(a)];
                p[find(a)] = find(b);
            }else if (operate.equals("Q1")){
                int a = Integer.parseInt(params1[1]);
                int b = Integer.parseInt(params1[2]);
                if (find(a) == find(b))
                    System.out.println("Yes");
                else 
                    System.out.println("No");
            }else {
                int a = Integer.parseInt(params1[1]);
                System.out.println(size[find(a)]);
            }
        }
        
    }
}
```

